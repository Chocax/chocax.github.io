---
import Header from "../components/Header.astro";
import Sidebar from "../components/Sidebar.astro";
---

<!DOCTYPE html>
<html lang="es">
  <Header title="Actividades | Santiago" />
  <body>
    <div class="content">
      <Sidebar selectedItem="actividades" />
      <nav class="main">
        <div class="container" style="max-width: 1200px; margin: 0 auto;"> <h2 style="margin-top: 40px; font-size: 2.5rem;">Actividades de Clase</h2>
          <p class="lead" style="margin-bottom: 40px; font-size: 1.2rem;">Recopilación de retos, consultas SQL complejas y ejercicios prácticos de bases de datos.</p>
          
          <div class="projects-section" style="display: flex; flex-direction: column; gap: 40px;">
            
            <div class="projects-container" style="background: #111; padding: 35px; border-radius: 18px; border: 1px solid #333; width: 100%; box-sizing: border-box;">
              <h3 style="color: #fff; margin-bottom: 15px; font-size: 1.5rem;">1. Análisis de Rotación de Cargos</h3>
              <p class="gray-color" style="margin-bottom: 25px; font-size: 1.1rem; line-height: 1.6;">Consulta diseñada para identificar empleados con trayectoria múltiple en la compañía. Se utilizan joins entre historial y empleados, junto con agrupación y filtrado `HAVING` para detectar más de un registro de cargo.</p>
              
              <div style="background: #080808; padding: 30px; border-radius: 12px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 1rem; overflow-x: auto; border: 1px solid #2a2a2a; box-shadow: inset 0 0 15px rgba(0,0,0,0.5);">
                <pre style="color: #e6e6e6; margin: 0; white-space: pre;"><code><span style="color: #c678dd;">SELECT</span> E.FIRST_NAME, H.EMPLOYEE_ID, <span style="color: #e5c07b;">COUNT</span>(*) <span style="color: #c678dd;">AS</span> job_count
<span style="color: #c678dd;">FROM</span> HR.JOB_HISTORY H 
<span style="color: #c678dd;">JOIN</span> HR.EMPLOYEES E <span style="color: #c678dd;">ON</span> H.EMPLOYEE_ID = E.EMPLOYEE_ID
<span style="color: #c678dd;">GROUP BY</span> E.FIRST_NAME, H.EMPLOYEE_ID
<span style="color: #c678dd;">HAVING COUNT</span>(*) > 1;</code></pre>
              </div>
            </div>

            <div class="projects-container" style="background: #111; padding: 35px; border-radius: 18px; border: 1px solid #333; width: 100%; box-sizing: border-box;">
              <h3 style="color: #fff; margin-bottom: 15px; font-size: 1.5rem;">2. Filtro Geográfico y Salarial Complejo</h3>
              <p class="gray-color" style="margin-bottom: 25px; font-size: 1.1rem; line-height: 1.6;">Esta consulta integra cuatro tablas (Employees, Departments, Locations, Countries) para filtrar personal en la región europea con un rango salarial específico (4k - 6k USD). Incluye concatenación de nombres.</p>
              
              <div style="background: #080808; padding: 30px; border-radius: 12px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 1rem; overflow-x: auto; border: 1px solid #2a2a2a; box-shadow: inset 0 0 15px rgba(0,0,0,0.5);">
                <pre style="color: #e6e6e6; margin: 0; white-space: pre;"><code><span style="color: #c678dd;">SELECT CONCAT</span>(E.FIRST_NAME, <span style="color: #98c379;">' '</span>, E.LAST_NAME) <span style="color: #c678dd;">AS</span> NAME, 
       C.COUNTRY_NAME <span style="color: #c678dd;">AS</span> COUNTRY, 
       E.SALARY
<span style="color: #c678dd;">FROM</span> HR.EMPLOYEES E 
<span style="color: #c678dd;">JOIN</span> HR.DEPARTMENTS D <span style="color: #c678dd;">ON</span> E.DEPARTMENT_ID = D.DEPARTMENT_ID
<span style="color: #c678dd;">JOIN</span> HR.LOCATIONS L <span style="color: #c678dd;">ON</span> L.LOCATION_ID = D.LOCATION_ID
<span style="color: #c678dd;">JOIN</span> HR.COUNTRIES C <span style="color: #c678dd;">ON</span> L.COUNTRY_ID = C.COUNTRY_ID
<span style="color: #c678dd;">WHERE</span> C.REGION_ID = 10 
  <span style="color: #c678dd;">AND</span> E.SALARY <span style="color: #c678dd;">BETWEEN</span> 4000 <span style="color: #c678dd;">AND</span> 6000;</code></pre>
              </div>
            </div>

            <div class="projects-container" style="background: #111; padding: 35px; border-radius: 18px; border: 1px solid #333; width: 100%; box-sizing: border-box;">
              <h3 style="color: #fff; margin-bottom: 15px; font-size: 1.5rem;">3. Jerarquía y Enmascaramiento de Datos</h3>
              <p class="gray-color" style="margin-bottom: 25px; font-size: 1.1rem; line-height: 1.6;">Proyección de la relación jerárquica empleado-jefe usando un `LEFT JOIN` (auto-relación). Se aplica seguridad visual enmascarando los emails con `SUBSTR` y `LPAD` para mostrar solo los primeros 3 caracteres.</p>
              
              <div style="background: #080808; padding: 30px; border-radius: 12px; font-family: 'Fira Code', 'Courier New', monospace; font-size: 1rem; overflow-x: auto; border: 1px solid #2a2a2a; box-shadow: inset 0 0 15px rgba(0,0,0,0.5);">
                <pre style="color: #e6e6e6; margin: 0; white-space: pre;"><code><span style="color: #c678dd;">SELECT</span> 
    E.FIRST_NAME || <span style="color: #98c379;">' '</span> || E.LAST_NAME <span style="color: #c678dd;">AS</span> EMPLEADO,
    <span style="color: #e5c07b;">LPAD</span>(<span style="color: #e5c07b;">SUBSTR</span>(E.EMAIL, 1, 3), 9, <span style="color: #98c379;">'*'</span>) <span style="color: #c678dd;">AS</span> EMAIL_EMPLEADO,
    M.FIRST_NAME || <span style="color: #98c379;">' '</span> || M.LAST_NAME <span style="color: #c678dd;">AS</span> JEFE,
    <span style="color: #e5c07b;">LPAD</span>(<span style="color: #e5c07b;">SUBSTR</span>(M.EMAIL, 1, 3), 9, <span style="color: #98c379;">'*'</span>) <span style="color: #c678dd;">AS</span> EMAIL_JEFE
<span style="color: #c678dd;">FROM</span> HR.EMPLOYEES E
<span style="color: #c678dd;">LEFT JOIN</span> HR.EMPLOYEES M <span style="color: #c678dd;">ON</span> E.MANAGER_ID = M.EMPLOYEE_ID
<span style="color: #c678dd;">ORDER BY</span> E.LAST_NAME;</code></pre>
              </div>
            </div>

          </div>
        </div>
      </nav>
    </div>
  </body>
</html>