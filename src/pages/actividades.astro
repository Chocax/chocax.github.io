---
import Header from "../components/Header.astro";
import Sidebar from "../components/Sidebar.astro";
---

<!DOCTYPE html>
<html lang="es">
  <Header title="Actividades | Santiago" />
  <body>
    <div class="content">
      <Sidebar selectedItem="actividades" />
      <nav class="main">
        <div class="container">
          <h2 style="margin-top: 40px;">Actividades de Clase</h2>
          <p class="lead">Recopilación de retos, consultas SQL y ejercicios prácticos de bases de datos.</p>
          
          <div class="projects-section" style="margin-top: 30px; display: flex; flex-direction: column; gap: 30px;">
            
            <div class="projects-container" style="background: #111; padding: 25px; border-radius: 15px; border: 1px solid #222;">
              <h4 style="color: #fff; margin-bottom: 10px;">1. Análisis de Rotación de Cargos</h4>
              <p class="gray-color" style="margin-bottom: 15px;">Consulta para identificar el número de empleados que han desempeñado más de un cargo dentro de la compañía, utilizando funciones de agregación y joins.</p>
              <div style="background: #000; padding: 20px; border-radius: 10px; font-family: 'Courier New', monospace; font-size: 0.9rem; overflow-x: auto; border: 1px solid #333;">
                <pre style="color: #62afef; margin: 0;"><code style="color: #c678dd;">SELECT</code> E.FIRST_NAME, H.EMPLOYEE_ID, <code style="color: #e5c07b;">COUNT</code>(*) <code style="color: #c678dd;">AS</code> job_count
<code style="color: #c678dd;">FROM</code> HR.JOB_HISTORY H <code style="color: #c678dd;">JOIN</code> HR.EMPLOYEES E
<code style="color: #c678dd;">ON</code> H.EMPLOYEE_ID = E.EMPLOYEE_ID
<code style="color: #c678dd;">GROUP BY</code> E.FIRST_NAME, H.EMPLOYEE_ID
<code style="color: #c678dd;">HAVING COUNT</code>(*) > 1;</pre>
              </div>
            </div>

            <div class="projects-container" style="background: #111; padding: 25px; border-radius: 15px; border: 1px solid #222;">
              <h4 style="color: #fff; margin-bottom: 10px;">2. Filtro Geográfico y Salarial</h4>
              <p class="gray-color" style="margin-bottom: 15px;">Identificación de personal ubicado en la región de Europa con un rango salarial específico (4000 - 6000 USD), integrando múltiples tablas (Employees, Departments, Locations y Countries).</p>
              <div style="background: #000; padding: 20px; border-radius: 10px; font-family: 'Courier New', monospace; font-size: 0.9rem; overflow-x: auto; border: 1px solid #333;">
                <pre style="color: #62afef; margin: 0;"><code style="color: #c678dd;">SELECT CONCAT</code>(E.FIRST_NAME, <code style="color: #98c379;">' '</code>, E.LAST_NAME) <code style="color: #c678dd;">AS</code> NAME, 
       C.COUNTRY_NAME <code style="color: #c678dd;">AS</code> COUNTRY, E.SALARY
<code style="color: #c678dd;">FROM</code> HR.EMPLOYEES E <code style="color: #c678dd;">JOIN</code> HR.DEPARTMENTS D
<code style="color: #c678dd;">ON</code> E.DEPARTMENT_ID = D.DEPARTMENT_ID
<code style="color: #c678dd;">JOIN</code> HR.LOCATIONS L <code style="color: #c678dd;">ON</code> L.LOCATION_ID = D.LOCATION_ID
<code style="color: #c678dd;">JOIN</code> HR.COUNTRIES C <code style="color: #c678dd;">ON</code> L.COUNTRY_ID = C.COUNTRY_ID
<code style="color: #c678dd;">WHERE</code> C.REGION_ID = 10 <code style="color: #c678dd;">AND</code> E.SALARY <code style="color: #c678dd;">BETWEEN</code> 4000 <code style="color: #c678dd;">AND</code> 6000;</pre>
              </div>
            </div>

            <div class="projects-container" style="background: #111; padding: 25px; border-radius: 15px; border: 1px solid #222;">
              <h4 style="color: #fff; margin-bottom: 10px;">3. Jerarquía y Seguridad de Datos (E-mails)</h4>
              <p class="gray-color" style="margin-bottom: 15px;">Proyección del orden jerárquico relacionando empleados con sus respectivos jefes. Incluye manipulación de strings para enmascarar correos electrónicos por motivos de seguridad.</p>
              <div style="background: #000; padding: 20px; border-radius: 10px; font-family: 'Courier New', monospace; font-size: 0.9rem; overflow-x: auto; border: 1px solid #333;">
                <pre style="color: #62afef; margin: 0;"><code style="color: #c678dd;">SELECT</code> 
    E.FIRST_NAME || <code style="color: #98c379;">' '</code> || E.LAST_NAME <code style="color: #c678dd;">AS</code> EMPLEADO,
    <code style="color: #e5c07b;">LPAD</code>(<code style="color: #e5c07b;">SUBSTR</code>(E.EMAIL, 1, 3), 9, <code style="color: #98c379;">'*'</code>) <code style="color: #c678dd;">AS</code> EMAIL_EMPLEADO,
    M.FIRST_NAME || <code style="color: #98c379;">' '</code> || M.LAST_NAME <code style="color: #c678dd;">AS</code> JEFE,
    <code style="color: #e5c07b;">LPAD</code>(<code style="color: #e5c07b;">SUBSTR</code>(M.EMAIL, 1, 3), 9, <code style="color: #98c379;">'*'</code>) <code style="color: #c678dd;">AS</code> EMAIL_JEFE
<code style="color: #c678dd;">FROM</code> HR.EMPLOYEES E
<code style="color: #c678dd;">LEFT JOIN</code> HR.EMPLOYEES M <code style="color: #c678dd;">ON</code> E.MANAGER_ID = M.EMPLOYEE_ID
<code style="color: #c678dd;">ORDER BY</code> E.LAST_NAME;</pre>
              </div>
            </div>

          </div>
        </div>
      </nav>
    </div>
  </body>
</html>